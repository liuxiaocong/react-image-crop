!function(t){var e={};function n(o){if(e[o])return e[o].exports;var i=e[o]={i:o,l:!1,exports:{}};return t[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e){t.exports={lastDescriptionKey:"canvas_last_description",lastActionInfoKey:"canvas_last_action_info",lastImageDataKey:"canvas_last_image_data",lastImageNameKey:"canvas_last_image_name"}},function(t,e,n){"use strict";n.r(e);var{lastDescriptionKey:o,lastActionInfoKey:i}=n(0);var a=(t,e,n,a,r,l,s,c,g,d,u)=>{const h=e.getContext("2d"),f=getComputedStyle(a,null),m=parseInt(f.width),p=parseInt(f.height),y=e.width,I=e.height,v=1440/y,S=(m-y)/2,x=(p-I)/2,w={},D={},A={lastDescription:null,lastActionInfo:null};try{A.lastDescription=localStorage.getItem(o)&&JSON.parse(localStorage.getItem(o)),A.lastActionInfo=localStorage.getItem(i)&&JSON.parse(localStorage.getItem(i))}catch(t){console.error(t)}let C=d,P=n,z=P.naturalWidth,b=P.naturalHeight,k=z>b,B=1,W=1,L=(5+B-1)/300,N={},_=!1,O=!1;return{start:function(){t.src=P.src,this.updateFileName(),this.initBackgroundImageSizeAndPosition(),this.initSizeControl(),a.addEventListener("mousedown",t=>{console.log(N),O=!0,w.x=t.clientX,w.y=t.clientY,w.imageX=N.x,w.imageY=N.y}),a.addEventListener("mouseup",t=>{O=!1}),a.addEventListener("mousemove",t=>{if(!O)return;const e=t.clientX-w.x,n=t.clientY-w.y,o=w.imageX,i=w.imageY;console.log(">>>>>>>>>>>>>>>>>>>>>>"),console.log(t),console.log("imageContainerStartPosition X:"+w.x),console.log("imageContainerStartPosition Y:"+w.y),console.log("moveX:"+e),console.log("moveY:"+n),console.log("imageX:"+o),console.log("imageY:"+i);let a=o+e,r=i+n;this.updateBackgroundImageSizeAndPosition(a,r,N.width,N.height)})},updateFileName:function(){g.innerText=u||"No File Chosen"},initSizeControl:function(){l&&(B=N.orginalHeight/I>N.orginalWidth/y?1/(N.orginalWidth/y):1/(N.orginalHeight/I),W=(1-B)/(L=(5+B)/300),l.style.left=W+"px",s.style.width=W/300*100+"%",r.addEventListener("mousedown",t=>{_=!0,D.left=l.style.left?parseInt(l.style.left):0,D.x=t.clientX,D.y=t.clientY}),r.addEventListener("mouseup",t=>{_=!1}),r.addEventListener("mousemove",t=>{if(!_)return;const e=t.clientX-D.x;let n=D.left+e;n<0&&(n=0),n>I&&(n=I),l.style.left=n+"px",s.style.width=n/I*100+"%",this.updateImageSizeWithControl(n)}))},updateImageSizeWithControl:function(t){let e=1+(t-W)*L;e<B&&(e=B),e>5&&(e=5);let n=N.orginalWidth*e,o=N.orginalHeight*e;n<y&&(n=y,o=N.orginalHeight/N.orginalWidth*n),o<I&&(o=I,n=N.orginalWidth/N.orginalHeight*o);const i=(n-N.width)/2,a=(o-N.height)/2,r=N.x-i,l=N.y-a;this.updateBackgroundImageSizeAndPosition(r,l,n,o)},initBackgroundImageSizeAndPosition:function(){if(k){const t=z/b*m;N.orginalWidth=t,N.orginalHeight=p,this.updateBackgroundImageSizeAndPosition(0,0,t,p)}else{const t=b/z*p;N.orginalWidth=m,N.orginalHeight=t,this.updateBackgroundImageSizeAndPosition(0,0,m,t)}},updateBackgroundImageSizeAndPosition:function(e,n,o,i){const a=S,r=x,l=S+y-N.width,s=x+I-N.height;let c=e,g=n;c>a&&(c=a),g>r&&(g=r),c<l&&(c=l),g<s&&(g=s),t.style.left=c+"px",t.style.top=g+"px",t.style.width=o+"px",t.style.height=i+"px",N=Object.assign(N,{x:c,y:g,width:o,height:i}),this.updateCanvasDisplay()},updateCanvasDisplay:function(){const e=S-N.x,n=x-N.y;console.log("canvasLeftPadding:"+S),console.log("canvasTopPadding:"+x),console.log("currentBackgroundImageInfo x"+N.x),console.log("currentBackgroundImageInfo y"+N.y),h.drawImage(P,-e,-n,t.width,t.height)},setBodyScrollEnable:function(t){document.body.style.overflow=t?"auto":"hidden"},convertBackgroundImageInfoToInch:function(){return{width:(N.width*v/96).toFixed(2),height:(N.height*v/96).toFixed(2),x:((S-N.x)*v/96).toFixed(2),y:((x-N.y)*v/96).toFixed(2)}},convertInchToBackgroundImageInfo:function(t,e,n,o){return{width:96*t/v,height:96*e/v,x:S-96*n/v,y:x-96*o/v}},showDescription:function(){const t=this.convertBackgroundImageInfoToInch(),e={canvas:{width:15,height:10,photo:{id:u,width:t.width,height:t.height,x:t.x,y:t.y}}},n={imageData:C,imageName:u};return l&&(n.sizeControllerLeft=l.style.left,n.sizeControlProgressWidth=s.style.width),A.lastDescription=e,A.lastActionInfo=n,c.style.display="inline-block",localStorage.setItem(o,JSON.stringify(e)),localStorage.setItem(i,JSON.stringify(n)),e},restoreLastDescription:function(){if(A.lastDescription&&A.lastActionInfo){let t=new Image;t.src=A.lastActionInfo.imageData,C=A.lastActionInfo.imageData;let e=this;t.onload=function(){P=t,u=A.lastActionInfo.imageName||"",z=P.naturalWidth,b=P.naturalHeight,k=z>b,e.start();const n=A.lastDescription.canvas.photo,o=e.convertInchToBackgroundImageInfo(n.width,n.height,n.x,n.y);e.updateBackgroundImageSizeAndPosition(o.x,o.y,o.width,o.height),l&&(l.style.left=A.lastActionInfo.sizeControllerLeft,s.style.width=A.lastActionInfo.sizeControlProgressWidth)}}},updatePercent:function(t=1){let e=t;e<B&&(e=B),e>5&&(e=5);let n=N.orginalWidth*e,o=N.orginalHeight*e;n<y&&(n=y,o=N.orginalHeight/N.orginalWidth*n),o<I&&(o=I,n=N.orginalWidth/N.orginalHeight*o);const i=(n-N.width)/2,a=(o-N.height)/2,r=N.x-i,l=N.y-a;this.updateBackgroundImageSizeAndPosition(r,l,n,o)}}};const{lastDescriptionKey:r,lastActionInfoKey:l}=n(0),s=function(){let t,e,n,o,i,s,c,g,d,u,h,f,m;const p=t=>{e&&(e.innerHTML+="<p>"+t+"</p>")};return{init:a=>{t=a.imageContainer,e=a.debugContainer,n=a.generateButton,o=a.loadPreviousButton,i=a.backgroundImage,s=a.canvas,c=a.sizeControllerWrap,g=a.sizeController,d=a.sizeControlProgress,u=a.fileNameDom,h=a.fileSelector,m=a.onCrop},start:()=>{h.onchange=function(e){for(var n,r=e.target.files,l=0;l<r.length;++l)switch((n=r[l]).type){case"image/jpeg":case"image/png":case"image/gif":var h=new FileReader;return h.onload=function(e){var r=new Image;r.src=h.result,r.onload=function(){var e=r.naturalWidth,l=r.naturalHeight;p("Loaded Image w/dimensions "+e+" x "+l),(f=a(i,s,r,t,c,g,d,o,u,h.result,n.name)).start()}},void h.readAsDataURL(n);default:p("not a valid Image file :"+n.name)}},n.onclick=function(t){p("GENERATE BUTTON CLICKED!! Should this do something else?"),f&&p(JSON.stringify(f.showDescription())),m&&"function"==typeof m&&m(f.showDescription())},o.onclick=function(e){if(h.value="",f)f.restoreLastDescription();else{const e=localStorage.getItem(r)&&JSON.parse(localStorage.getItem(r)),n=localStorage.getItem(l)&&JSON.parse(localStorage.getItem(l));if(!n||!e)return;let h=new Image;h.src=n.imageData,h.onload=function(){var e=h.naturalWidth,r=h.naturalHeight;p("Loaded Image w/dimensions "+e+" x "+r),(f=a(i,s,h,t,c,g,d,o,u,n.imageData,n.imageName||"")).start(),f.restoreLastDescription()}}}},sizeSize:(t=1)=>{}}}();e.default=s}]);